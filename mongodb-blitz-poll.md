# Express.JS Интервью Вопросы 

![MongoDB-Logo](img/mongodb-bliz-50.jpg)

## 1. Что вы понимаете под базами данных NoSQL?
Существует проблема обработки больших данных, неструктурированных данных и полуструктурированных данных, поэтому NoSQL является ответом на все эти проблемы.

NoSQL означает «Не только SQL». NoSQL - это тип базы данных, который может обрабатывать и сортировать все типы неструктурированных, грязных и сложных данных.

---

## 2. Является ли MongoDB базой данных NoSQL?
Да. MongoDB - это база данных NoSQL.

---

## 3. Какие существуют типы баз данных NoSQL? Приведите пример.
Базы данных NoSQL обычно попадают в одну из четырех категорий:

1. **Key-Value Store**:
  Каждый элемент в базе данных хранится как имя атрибута (или «ключ») вместе с его значением.
  Пример: Riak, Voldemort, Amazon S3 (Dynamo) и Redis и т.д.

2. **Document based databases**:
  они связывают каждый ключ со сложной структурой данных, известной как документ. Документы могут содержать много разных пар ключ-значение, или пары ключ-массив, или даже вложенные документы.
  Пример: MongoDB

3. **Column based Store**:
  они хранят данные вместе в виде столбцов вместо строк и оптимизирован для запросов по большим наборам данных.
  Пример:  Cassandra, HBase и др.

4. **Graph base databases**:
  используются для хранения информации о сетях, таких как социальные связи.
  Пример: Neo4J и HyperGraphDB и др.

---

## 4. Список самых популярных баз данных NoSQL?
Ниже приведены наиболее популярные базы данных NoSQL:

1. MongoDB
2. DynamoDB
3. Cassandra
4. CouchBD
5. Hypertable
6. Redis
7. Riak
8. Neo4j
9. HBASE
10. Couchbase
11. MemcacheDB
12. Voldemort
13. RevenDB

---

## 5. Какие языки поддерживаются MongoDB?
MongoDB обеспечивает официальную поддержку драйверов для C, C ++, C #, Java, Node.js, Perl, PHP, Python, Ruby, Scala и т. д.

---

## 6. MongoDB лучше, чем другие базы данных SQL? Если да, то почему?
Да, MongoDB лучше, чем другие базы данных SQL

Причины:

1. High Performance - Высокая производительность
  MongoDB обеспечивает высокую производительность хранения данных. Она поддерживает встроенные модели данных для уменьшения активности ввода-вывода в системе баз данных, а также индексы для более быстрых запросов и может включать ключи из встроенных документов и массивов.

2. High Availability - Высокая доступность
  Для обеспечения высокого качества доступности средство репликации MongoDb (известное как наборы реплик) обеспечивает как автоматическое переключение при сбое, так и при избыточности данных. Набор реплик - это группа серверов MongoDB, которые поддерживают один и тот же набор данных и обеспечивают как избыточность, так и повышенную доступность данных.

3. Automatic Scaling - Автоматическое масштабирование
  MongoDB обеспечивает горизонтальную масштабируемость как часть своей основной функциональности. Автоматическое разбиение данных распределяет данные по кластеру машин, в то время как наборы реплик могут обеспечить в конечном итоге согласованное чтение для развертываний с низкой задержкой.

4. Schema Less
  Модель данных JSON с динамическими схемами.

5. Лучше всего подходит для полуструктурированных / неструктурированных данных, а также структурированных данных. Специальные запросы, индексация и агрегация в реальном времени предоставляют мощные способы доступа и анализа ваших данных.

6. MongoDB является бесплатной и с открытым исходным кодом, опубликованной в соответствии с GNU Affero General Public License

---

## 7. Почему MongoDB известен как лучшая база данных NoSQL?
MongoDb - лучшая база данных NoSQL, потому что она:

1. Ориентированна на документ - документоориентирована.
2. Богатый язык запросов
3. Высокая производительность
4. Высокая доступность
5. Легко масштабируема

---

## 8. Что такое mongo в MongoDB?
mongo - это интерактивный интерфейс JavaScript-оболочки для MongoDB, который предоставляет мощный интерфейс для системных администраторов, а также позволяет разработчикам тестировать запросы и операции непосредственно с базой данных.

---

## 9. Что такое mongod в MongoDB?
Сервер базы данных MongoDB. Процесс mongod запускает сервер MongoDB как демон. Сервер MongoDB управляет запросами и форматами данных и управляет фоновыми операциями

---

## 10. Что такое mongos в MongoDB?
Процесс маршрутизации и балансировки нагрузки, который действует как интерфейс между приложением и сегментированным кластером MongoDB.

---

## 11. Что такое пространство имен в MongoDB?
MongoDB хранит объекты BSON (двоичная структура обмена и структура объектов) в коллекциях.

Объединение имени базы данных и имени коллекции (с точкой между ними) называется пространством имен.

---

## 12. Что такое oplog в MongoDB?
Ограниченная коллекция, в которой хранится упорядоченная история логических записей в базу данных MongoDB. Оплог является основным механизмом, обеспечивающим репликацию в MongoDB.

---

## 13. Что такое проекция MongoDB?
Проекция MongoDB означает выбор только необходимых данных, а не выборку всех данных документа.

```json
//User Collection
{
	"_id" : ObjectId("25bf63380be1d7770c3982af"),
	"name" : "Test 1",
	"email" : "test1@test.com",
	"age" : 22
}
{
	"_id" : ObjectId("12bf63500be1d7770c3982b0"),
	"name" : "Test 2",
	"email" : "test2@test.com",
	"age" : 22
}
{
	"_id" : ObjectId("34bf63650be1d7770c3982b1"),
	"name" : "Test 3",
	"email" : "test3@test.com",
	"age" : 23
}
//Чтобы получить только имена пользователей для всех документов, мы будем использовать проекцию, подобную этой:
> db.user.find({}, {"_id": 0, "name": 1});
{ "name" : "Test 1" }
{ "name" : "Test 2" }
{ "name" : "Test 3" }
```

---

## 14. Есть ли у MongoDB  Schema - схема?
Да, MongoDB имеет динамическую схему, поэтому нет необходимости определять структуру для создания коллекций в MongoDB.

---

## 15. Поддерживает ли MongoDB взаимосвязь primary-key и foreign-key ключей?
Нет. По умолчанию MongoDB не поддерживает отношения primary key-foreign key.

>Но в MongoDB мы можем достичь отношения  primary key-foreign key, встраивая ссылки.

Пример: Адресный документ может быть встроен в пользовательский документ.

```json 
{
   _id: "4f7ee46e08403d063ab0b4f9",
   name: "Harry",
   addresses: [
                {
                  street: "123 Street 1",
                  city: "New Delhi",
                  state: "New Delhi",
                  zip: "12345"
                },
                {
                  street: "Some Other Street",
                  city: "Boston",
                  state: "MA",
                  zip: "12345"
                }
              ]
 }
 
```
---

## 16. Что такое pipeline - конвейер в MongoDB?
**Серия операций в процессе агрегации.**

Агрегационный конвейер - aggregation pipeline MongoDB состоит из этапов. Каждый этап трансформирует документы по мере их прохождения по конвейеру. Стадии конвейера не должны создавать один выходной документ для каждого входного документа; например, некоторые этапы могут генерировать новые документы или фильтровать документы. Этапы конвейера могут появляться в конвейере несколько раз.

MongoDB предоставляет метод `db.collection.aggregate ()` в оболочке mongo и команду `aggregate` для конвейера агрегации.

---

## 17. Нужно ли MongoDB много оперативной памяти RAM?
Нет. Для запуска MongoDB не нужно много оперативной памяти. Её можно запустить даже на небольшом объеме оперативной памяти, поскольку он динамически распределяет и освобождает оперативную память в соответствии с требованиями процессов.

---

## 18. Объясните структуру ObjectID в MongoDB.
`ObjectId ()` является 12-байтовым типом BSON.

Это:
1. Значение 4 байта, представляющее секунды
2. 3-х байтовый идентификатор машины
3. 2-байтовый идентификатор процесса
4. Счетчик 3 байта

---

## 19. Правда ли, что MongoDB использует BSON для представления структуры документа?
Да!

---

## 20. Что такое индексы в MongoDB?
В MongoDB индексы используются для эффективного выполнения запросов.

Без индексов MongoDB должна была бы выполнить сканирование коллекции, то есть отсканировать каждый документ в коллекции, чтобы выбрать те документы, которые соответствуют оператору запроса. Если для запроса существует соответствующий индекс, MongoDB может использовать этот индекс для ограничения количества документов, которые она должна проверять.

---

## 21. По умолчанию какой индекс создается MongoDB для каждой коллекции?
По умолчанию коллекция `_id` создается для каждой коллекции MongoDB.
Чтобы создать индекс в оболочке Mongo, используйте `db.collection.createIndex ()`.

Synatx:
```js
db.collection.createIndex(keys, options);
```

Пример:

```js
 db.user.createIndex( { name: -1 } );
```

В MongoDB есть следующие типы индексов

1. Single Field - Одиночное поле
2. Compound Index - Составной индекс
3. Multikey Index - Multikey Index
4. Geospatial Index - Геопространственный индекс
5. Text Indexes - Текстовые индексы
6. Hashed Indexes - Хешированные индексы

Пример: создание индекса на нескольких полях
В следующем примере создается составной индекс для поля имени пользователя (в порядке возрастания) и поля города (в порядке убывания).

```js
db.user.createIndex( { "username": 1 , "city": -1 } );
```
ПРИМЕЧАНИЕ: порядок индекса
Порядок индекса важен для поддержки операций `sort ()`, использующих индекс.

Метод `createIndex ()` имеет поведение, описанное здесь.

1. Чтобы добавить или изменить параметры индекса, вы должны удалить индекс с помощью метода `dropIndex ()` и выполнить другую операцию `createIndex ()` с новыми параметрами.

2. Если вы создаете индекс с одним набором параметров, а затем запускаете метод `createIndex ()` с теми же полями индекса и различными параметрами без предварительного удаления индекса, `createIndex ()` не будет перестраивать существующий индекс с новыми параметрами.

3. Если вы вызываете несколько методов `createIndex ()` с одной и той же спецификацией индекса в одно и то же время, только первая операция будет выполнена успешно, все остальные операции не будут иметь никакого эффекта.

4. Не фоновые операции индексации блокируют все остальные операции в базе данных.

5. MongoDB не будет создавать индекс для коллекции, если запись индекса для существующего документа превышает максимальную длину ключа индекса.

**Дополнительная информация**:
*Примечание-1*: Используйте `db.collection.createIndex ()` вместо `db.collection.ensureIndex ()` для создания индексов.

*Примечание-2*: `db.collection.getIndexes ()` для просмотра спецификаций существующих индексов для коллекции.

---

## 22. На каком языке написана MongoDB?
MongoDB написана и реализована на C ++.

---

## 23. Как сделать транзакцию / блокировку (Transaction/locking) в MongoDB?
MongoDB не использует традиционную блокировку или сложную транзакцию с Commit и Rollback.

MongoDB разработан а таким образом, чтобы быть легковесной, быстрой и предсказуемой. Это упрощает поддержку транзакций для повышения производительности.

---

## 24. Почему 32-битная версия MongoDB не является предпочтительной?
Поскольку MongoDB использует файлы с отображенной памятью, поэтому при запуске 32-разрядной сборки MongoDB общий объем хранилища сервера составляет 2 ГБ. Но когда вы запускаете 64-битную сборку MongoDB, это обеспечивает практически неограниченный размер хранилища. Так что 64-битная версия предпочтительнее 32-битной.

---

## 25. Что такое `explain()` в MongoDB?
В оболочке Mongo вы также можете получить информацию о плане запроса с помощью метода `explain()`:

```js
db.collection.explain();
```

---

## 26. Может ли одна операция MongoDB заблокировать более одной базы данных? Если да, то как?
Да. Такие операции, как `copyDatabase ()`, `repairDatabase ()` и т. д., Могут заблокировать несколько задействованных баз данных.

---

## 27. Что такое `Storage Engine` в MongoDB?
`Storage Engine` - это часть базы данных, которая отвечает за управление хранением данных на диске.

Например, один механизм хранения может предложить более высокую производительность для рабочих нагрузок с интенсивным чтением, а другой может поддерживать более высокую пропускную способность для операций записи.

**Самый простой способ найти механизм хранения, используемый в настоящее время.**
```js
db.serverStatus().storageEngine;

//Output:

{ "name" : "wiredTiger" }
```

Как только будет подтверждено, что используется `wiredTiger`, введите

```js
db.serverStatus().wiredTiger;
```
чтобы получить все детали конфигурации `wiredTiger`.

---

## 28. Какие два механизма хранения используются MongoDB?
MongoDB использует:
1. MMAPv1
2. WiredTiger

---

## 29. Предоставляет ли MongoDB средство для текстового поиска? Как?
Да, MongoDB поддерживает создание текстовых индексов для поддержки текстового поиска внутри строкового содержимого. Это была новая функция, которая может быть введена в версии 2.6.

---

## 30. Что такое 32-битные нюансы?
Существует дополнительная активность файла с отображенной памятью при ведении журнала. Это дополнительно ограничит ограниченный размер БД 32-битных сборок. На данный момент ведение журнала по умолчанию отключено на 32-битных системах.

---

## 31. Почему Profiler используется в MongoDB?
Инструмент, который при включении ведет учет всех длительных операций в коллекции базы данных `system.profile`.

Профилировщик чаще всего используется для диагностики медленных запросов.

Включить профилирование:
```js
db.setProfilingLevel(1);
```
Теперь дайте ему немного поработать. Он собирает медленные запросы (> 100 мс) в ограниченные коллекции, поэтому запросы поступают, а если он полон, старые запросы выходят, поэтому не удивляйтесь, что это движущаяся цель

Найдите самый последний медленный запрос:
```js
db.system.profile.find().sort({$natural: -1}).limit(1)
```

---

## 32. Что такое `map-reduce` в MongoDB?
Парадигма обработки и агрегации данных, состоящая из фазы «`map`», которая выбирает данные, и фазы «`reduce`», которая преобразует данные. В MongoDB вы можете запускать произвольные агрегации по данным, используя `map-reduce`.

Для операций `map-reduce` MongoDB предоставляет команду базы данных `mapReduce`.

---

## 33. Объясните репликацию в MongoDB?
* Репликация - это процесс синхронизации данных между несколькими серверами.
* Репликация обеспечивает избыточность и повышает доступность данных благодаря множеству копий данных на разных серверах баз данных.
* Репликация также позволяет восстанавливаться после сбоя оборудования и перерывов в обслуживании.

Больше информации - https://docs.mongodb.com/manual/replication/

---

## 34. Когда атрибут объекта удаляется, он удаляется из store?
Да, вы можете удалить атрибут и затем повторно `re-save()` - сохранить объект.

---

## 35. Разрешены ли нулевые -`null` значения в MongoDB?
Да, но только для части объекта. Нулевое значение нельзя добавить в коллекцию базы данных, поскольку оно не является объектом. Но `{}` можно добавить.

---

## 36. Есть ли немедленное обновление fsync на диск?
Нет. Запись на диск по умолчанию ленива - `lazy`. Запись может появиться на диске только через пару секунд. Например, если база данных получает тысячу приращений к объекту в течение одной секунды, она будет записана на диск только один раз. (Примечание: параметры `fsync` доступны как в командной строке, так и через `getLastError_old`.)

---

## 37. Почему файлы данных такие большие?
MongoDB делает агрессивное предварительное распределение зарезервированного пространства, чтобы избежать фрагментации файловой системы.

---

## 38. Сколько времени занимает `eplica set failover` - отработка отказа реплики?
Может потребоваться 10-30 секунд для того, чтобы основной состав был объявлен другими участниками, и новый основной был избран. В течение этого промежутка времени кластер не работает для основных операций, т. е. Операций записи и последовательного чтения. Однако, в конце концов, согласованные запросы могут быть выполнены к вторичным серверам в любое время (в режиме `slaveOk`), в том числе в течение этого окна.

---

## 39. Что такое Master или Primary?
Это node/member , который в настоящее время является основным и обрабатывает все записи для набора реплик. Во время  ( failover event in a replica set ) события отработки отказа в наборе реплик, другой элемент может стать основным.

---

## 40. Что такое Secondary или Slave?
Вторичный узел - Secondary - это node/member, который применяет операции из текущего первичного узла. Это делается путем подгонки оплог репликации (`local.oplog.rs`). Репликация с первичной на вторичную является асинхронной, однако вторичное устройство будет стараться оставаться максимально близким к текущему (часто это составляет всего несколько миллисекунд в локальной сети LAN).

---

## 41. Обязательно ли вызывать getLastError, чтобы сделать запись надежной?
Нет. Если «`getLastError`» (он же «Безопасный режим») не вызывается, сервер ведет себя точно так, как если бы он был вызван. Вызов `getLastError` просто позволяет получить подтверждение того, что операция записи была успешно завершена. Конечно, вам часто требуется это подтверждение, но безопасность записи и ее долговечность от этого не зависят.

---

## 42. Что такое sharding в MongoDB?
Архитектура базы данных, которая разделяет данные по ключевым диапазонам и распределяет данные между двумя или более экземплярами базы данных. `Sharding` позволяет горизонтальное масштабирование.

* В MongoDB `Sharding` - это процедура хранения записей данных на нескольких машинах.
* Это подход MongoDB для удовлетворения потребностей роста данных.
* Он создает горизонтальный раздел данных в базе данных или поисковой системе.
* Каждый раздел упоминается как `shard` или `database shard`.

---

## 43. Стоит ли начинать с Sharded или с не Sharded среды MongoDB?
Для простоты и быстрого запуска мы рекомендуем начать «Без Sharded», если только ваш начальный набор данных не поместится на отдельных серверах. Обновление до Sharded с Non-sharded - это просто и без проблем, поэтому нет большого преимущества в настройке Sharding до того, как ваш набор данных станет большим.

---

## 44. Как Sharding работает с репликацией?
Каждый Shard  представляет собой логическую коллекцию секционированных данных. Shard  может состоять из одного сервера или кластера реплик. Настоятельно рекомендуется использовать набор реплик для каждого Shard.

---

## 45. Когда будут данные более чем на одном Shard?
MongoDB Sharding основан на диапазоне. Таким образом, все объекты в коллекции лежат в кусках - `chunks`. Только при наличии более одного чанка существует возможность получения данных несколькими шардами. В настоящее время размер чанка по умолчанию составляет 64 МБ, поэтому для миграции вам нужно не менее 64 МБ.

---

## 46. Что происходит, когда документ обновляется в перемещаемом (migrated) фрагменте (chunk)?
Обновление будет немедленно выполнено на старом Shard, а затем изменение будет перенесено на новый Shard до передачи права собственности.

---

## 47. Что происходит, когда Shard падает (останавливается) или замедляется при запросе?
Если Shard не работает, запрос вернет ошибку, если не заданы параметры запроса «Partial». Если Shard реагирует медленно, Mongos будет ждать его.

---

## 48. Можно ли удалить старые файлы из каталога «moveChunk»?
Да, эти файлы создаются как резервные копии во время обычных операций балансировки Shard. После завершения операций они могут быть удалены. Процесс очистки в настоящее время выполняется вручную, поэтому об этом необходимо позаботиться, чтобы освободить место.

---

## 49. Как вы видите связи, используемые Mongos?
Необходимо использовать следующую команду:
```js
db._adminCommand("connPoolStats");
```
**Если «moveChunk» завершается неудачно, необходимо ли очищать частично перемещенные документы?** Нет, движения фрагментов (chunk) последовательны и детерминированы. Перемещение будет повторено, и после завершения данные будут только на новом шарде.

---

## 50. Каковы лучшие функции или преимущества Mongodb?

1. Document-oriented - Документ-ориентированный
2. High performance - Высокая производительность
3. High availability - Высокая доступность
4. Easy scalability - Легкая масштабируемость
5. Rich-query language - Богатый язык запросов

---

## 51. Каковы недостатки MongoDB?
1. **Размер документа**
  Максимальный размер документа 16 МБ.

2. **Транзакции**
  Нет поддержки транзакций по умолчанию; Вы должны справиться с этим самостоятельно.

3. **Joins- присоединение**
  В MongoDB сложно представить отношения между данными, поэтому в конечном итоге вы делаете это вручную, создавая другую таблицу для представления отношений между строками в двух или более таблицах.

4. Стандартная установка MongoDB имеет асинхронный и пакетный коммит, включающий значение, он лежит при запросе сохранения чего-либо в БД и фиксирует все изменения в пакете позже в будущем. В случае сбоя сервера или сбоя питания все эти коммиты, сохраненные в памяти, будут потеряны. Эта функциональность может быть отключена, но тогда она будет работать так же хорошо или хуже, чем MySQL.

5. MongoDB идеально подходит только для реализации таких вещей, как аналитика / кэширование, где влияние небольшой потери данных незначительно.

---
---